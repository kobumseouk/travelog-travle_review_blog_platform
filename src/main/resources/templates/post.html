<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" >
<head th:replace="~{fragments/header :: header}"></head>
<body class="h-full flex flex-col">
<div th:replace="~{fragments/bodyHeader :: bodyHeader}"></div>
<link rel="stylesheet" href="/css/comment_photos.css">
<header>
    <div class="mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8">
        <h1 class="text-3xl font-bold tracking-tight text-gray-900">게시글 제목</h1>
    </div>
</header>
<div class="h-full">
    <main class="flex flex-col md:flex-row md:w-[90%]"> <!-- 모바일에서는 flex-col, 데스크탑에서는 flex-row -->
        <div class="md:w-3/5 w-[90%] m-10 bg-gray-50 p-6 shadow-xl rounded-lg flex-shrink-0" style="align-self: flex-start;">
            <!--            <div class="flex items-center justify-between">-->
            <!--                <div class="inline-flex items-center">-->
            <!--                    <img src="data:image/jpeg;base64,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" alt="프로필 사진" class="w-12 h-12 rounded-full border-2 border-gray-500">-->
            <!--                    <div class="ml-4">-->
            <!--                        <h2 class="text-xl font-bold text-gray-900">작성자 정보</h2>-->
            <!--                        <p class="text-gray-600">작성 일자</p>-->
            <!--                    </div>-->
            <!--                </div>-->
            <!--            </div>-->
            <!--            <div class="bg-gray-200 mt-4 mb-4 p-6 rounded-lg">-->
            <!--                <h2 class="text-xl font-bold  mb-4">게시글 제목</h2>-->
            <!--                <p class="text-gray-700" style="white-space: pre-line; word-break: break-all">게시글 내용</p>-->
            <!--            </div>-->
        </div>

        <div class="w-full md:w-[37%] w-90% mb-10 md:m-10 bg-gray-50 p-6 shadow-xl rounded-lg flex-shrink-0" style="align-self: flex-start;">
            <h2 th:text="'로그인 멤버 id = ' + ${loginMember}"></h2>
            <form class="mt-5 mb-5" th:action="@{/api/comment/{postId}(postId=${postId})}" th:object="${commentRequestDto}" method="post" enctype="multipart/form-data" onsubmit="return validateForm()"
                  th:data-post-id="${postId}">
                <label th:for="content" class="block text-lg font-semibold mb-2"><strong>댓글 작성</strong></label>

                <div class="flex flex-col">
                    <input type="text" th:field="*{memberId}" placeholder="멤버 id" required />
                    <textarea th:field="*{content}" class="flex-1 border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-500 mb-2" placeholder="작성 내용을 입력하세요" rows="5" required></textarea>

                    <div class="mb-2">
                        <input type="file" th:field="*{photos}" multiple id="file-input" class="hidden" />
                        <span class="text-sm text-gray-500 mt-2 block">최대 5개 파일 선택 가능</span>
                        <div id="file-info" class="mt-2 text-gray-500"></div>

                        <div class="flex flex-row justify-between">
                            <label for="file-input" class="flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg cursor-pointer hover:bg-blue-700 transition duration-300">
                                파일 선택하기
                            </label>
                            <button type="submit" class="bg-blue-500 text-white rounded-lg px-2 py-2 hover:bg-blue-600 transition duration-300">댓글 작성</button>
                        </div>
                    </div>
                </div>

                <div class="error-class mt-2 text-red-600" th:errors="*{content}"></div>
            </form>


            <div th:each="comment : ${post.getComments()}" class="flex items-start mb-4">
                <div class="flex w-2 h-2 bg-gray-400 rounded-full mr-4 mt-3"></div>
                <div class="flex-1">
                    <p class="font-bold mt-1 mb-2" th:text="${comment.getMember().name}"></p>
                    <div class="relative mb-1">
                        <div class="bg-gray-200 p-4 rounded-lg">
                            <span th:text="${comment.content}"></span>
                            <div class="mt-1" th:each="photo : ${comment.getCommentPhotos()}">
                                <a th:href="${photo.imagePath}" target="_blank" class="image-link">
                                    <img th:src="${photo.imagePath}" class="object-cover" />
                                </a>
                            </div>

                            <!-- 아직은 정보 일치하는 회원만 수정, 삭제만 가능함 (추후에 관리자도 가능?)-->
                            <div class="flex justify-end mt-2 mb-1">
                                <p th:if="${loginMember != null and loginMember == comment.member.id}">
                                    <a th:href="@{/post/{postId}/comment/update/{commentId}(postId=${postId}, commentId=${comment.id})}">
                                        <span class="material-symbols-outlined" style="color: blue">edit_note</span>
                                    </a>
                                    <button type="button" onclick="deleteComment(this)" th:data-id="${comment.id}">
                                        <span class="material-symbols-outlined" style="color: red">delete</span>
                                    </button>
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-end mb-2">
                        <span class="text-gray-500 text-sm ml-1" th:text="${#temporals.format(comment.created_at, 'yyyy-MM-dd HH:mm')}"></span>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<div th:replace="~{fragments/footer :: footer}"></div>
</body>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="/js/footer.js"></script>
<script src="/js/comment_photos.js"></script>
<script src="/js/comment_delete.js"></script>
</html>